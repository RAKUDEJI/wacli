// Generated by `wit-bindgen` 0.51.0. DO NOT EDIT!

pub fn wasmExportListCommands() -> Int {

      let (result) : (Array[@types.CommandMeta]) = @registry.list_commands();

      let address8 = mbt_ffi_malloc((result).length() * 60);
      for index9 = 0; index9 < (result).length(); index9 = index9 + 1 {
            let iter_elem : @types.CommandMeta = (result)[(index9)]
            let iter_base = address8 + (index9 * 60);

            let ptr = mbt_ffi_str2ptr((iter_elem).name)
            mbt_ffi_store32((iter_base) + 4, (iter_elem).name.length())
            mbt_ffi_store32((iter_base) + 0, ptr)

            let ptr0 = mbt_ffi_str2ptr((iter_elem).summary)
            mbt_ffi_store32((iter_base) + 12, (iter_elem).summary.length())
            mbt_ffi_store32((iter_base) + 8, ptr0)

            let ptr1 = mbt_ffi_str2ptr((iter_elem).usage)
            mbt_ffi_store32((iter_base) + 20, (iter_elem).usage.length())
            mbt_ffi_store32((iter_base) + 16, ptr1)

            let address = mbt_ffi_malloc(((iter_elem).aliases).length() * 8);
            for index = 0; index < ((iter_elem).aliases).length(); index = index + 1 {
                  let iter_elem : String = ((iter_elem).aliases)[(index)]
                  let iter_base = address + (index * 8);

                  let ptr2 = mbt_ffi_str2ptr(iter_elem)
                  mbt_ffi_store32((iter_base) + 4, iter_elem.length())
                  mbt_ffi_store32((iter_base) + 0, ptr2)

            }
            mbt_ffi_store32((iter_base) + 28, ((iter_elem).aliases).length())
            mbt_ffi_store32((iter_base) + 24, address)

            let ptr3 = mbt_ffi_str2ptr((iter_elem).version)
            mbt_ffi_store32((iter_base) + 36, (iter_elem).version.length())
            mbt_ffi_store32((iter_base) + 32, ptr3)
            mbt_ffi_store8((iter_base) + 40, (if (iter_elem).hidden { 1 } else { 0 }))

            let ptr4 = mbt_ffi_str2ptr((iter_elem).description)
            mbt_ffi_store32((iter_base) + 48, (iter_elem).description.length())
            mbt_ffi_store32((iter_base) + 44, ptr4)

            let address6 = mbt_ffi_malloc(((iter_elem).examples).length() * 8);
            for index7 = 0; index7 < ((iter_elem).examples).length(); index7 = index7 + 1 {
                  let iter_elem : String = ((iter_elem).examples)[(index7)]
                  let iter_base = address6 + (index7 * 8);

                  let ptr5 = mbt_ffi_str2ptr(iter_elem)
                  mbt_ffi_store32((iter_base) + 4, iter_elem.length())
                  mbt_ffi_store32((iter_base) + 0, ptr5)

            }
            mbt_ffi_store32((iter_base) + 56, ((iter_elem).examples).length())
            mbt_ffi_store32((iter_base) + 52, address6)

      }
      mbt_ffi_store32((return_area) + 4, (result).length())
      mbt_ffi_store32((return_area) + 0, address8)
      return return_area

}

pub fn wasmExportListCommandsPostReturn(p0 : Int) -> Unit {

      for index1 = 0; index1 < (mbt_ffi_load32((p0) + 4)); index1 = index1 + 1 {
            let iter_base = (mbt_ffi_load32((p0) + 0)) + (index1 * 60)
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 0))
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 8))
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 16))

            for index = 0; index < (mbt_ffi_load32((iter_base) + 28)); index = index + 1 {
                  let iter_base = (mbt_ffi_load32((iter_base) + 24)) + (index * 8)
                  mbt_ffi_free(mbt_ffi_load32((iter_base) + 0))

            }
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 24))
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 32))
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 44))

            for index0 = 0; index0 < (mbt_ffi_load32((iter_base) + 56)); index0 = index0 + 1 {
                  let iter_base = (mbt_ffi_load32((iter_base) + 52)) + (index0 * 8)
                  mbt_ffi_free(mbt_ffi_load32((iter_base) + 0))

            }
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 52))

      }
      mbt_ffi_free(mbt_ffi_load32((p0) + 0))

}

pub fn wasmExportRun(p0 : Int, p1 : Int, p2 : Int, p3 : Int) -> Int {

      let result = mbt_ffi_ptr2str(p0, p1)

      let array : Array[String] = [];
      for index = 0; index < (p3); index = index + 1 {
            let iter_base = (p2) + (index * 8)

            let result0 = mbt_ffi_ptr2str(mbt_ffi_load32((iter_base) + 0), mbt_ffi_load32((iter_base) + 4))

            array.push(result0)
      }
      mbt_ffi_free(p2)

      let (result1) : (Result[UInt, @types.CommandError]) = @registry.run(result, array);

      match result1 {
            Ok(payload) => {
                  mbt_ffi_store8((return_area) + 0, (0))
                  mbt_ffi_store32((return_area) + 4, (payload).reinterpret_as_int())

                  ()
            }
            Err(payload2) => {
                  mbt_ffi_store8((return_area) + 0, (1))

                  match payload2 {
                        UnknownCommand(payload3) => {
                              mbt_ffi_store8((return_area) + 4, (0))

                              let ptr = mbt_ffi_str2ptr(payload3)
                              mbt_ffi_store32((return_area) + 12, payload3.length())
                              mbt_ffi_store32((return_area) + 8, ptr)

                              ()
                        }
                        InvalidArgs(payload4) => {
                              mbt_ffi_store8((return_area) + 4, (1))

                              let ptr5 = mbt_ffi_str2ptr(payload4)
                              mbt_ffi_store32((return_area) + 12, payload4.length())
                              mbt_ffi_store32((return_area) + 8, ptr5)

                              ()
                        }
                        Failed(payload6) => {
                              mbt_ffi_store8((return_area) + 4, (2))

                              let ptr7 = mbt_ffi_str2ptr(payload6)
                              mbt_ffi_store32((return_area) + 12, payload6.length())
                              mbt_ffi_store32((return_area) + 8, ptr7)

                              ()
                        }
                        Io(payload8) => {
                              mbt_ffi_store8((return_area) + 4, (3))

                              let ptr9 = mbt_ffi_str2ptr(payload8)
                              mbt_ffi_store32((return_area) + 12, payload8.length())
                              mbt_ffi_store32((return_area) + 8, ptr9)

                              ()
                        }
                  }

                  ()
            }
      }
      return return_area

}

pub fn wasmExportRunPostReturn(p0 : Int) -> Unit {

      match (mbt_ffi_load8_u((p0) + 0)) {
            0 => ()
            1 => {

                  match (mbt_ffi_load8_u((p0) + 4)) {
                        0 => {
                              mbt_ffi_free(mbt_ffi_load32((p0) + 8))

                        }
                        1 => {
                              mbt_ffi_free(mbt_ffi_load32((p0) + 8))

                        }
                        2 => {
                              mbt_ffi_free(mbt_ffi_load32((p0) + 8))

                        }
                        3 => {
                              mbt_ffi_free(mbt_ffi_load32((p0) + 8))

                        }
                        _ => panic()
                  }

            }
            _ => panic()
      }

}

