// Generated by `wit-bindgen` 0.51.0. DO NOT EDIT!
///|
pub fn list_commands() -> Array[@types.CommandMeta] {

      let return_area = mbt_ffi_malloc(8)
      wasmImportListCommands(return_area);

      let array4 : Array[@types.CommandMeta] = [];
      for index5 = 0; index5 < (mbt_ffi_load32((return_area) + 4)); index5 = index5 + 1 {
            let iter_base = (mbt_ffi_load32((return_area) + 0)) + (index5 * 44)

            let result = mbt_ffi_ptr2str(mbt_ffi_load32((iter_base) + 0), mbt_ffi_load32((iter_base) + 4))

            let result0 = mbt_ffi_ptr2str(mbt_ffi_load32((iter_base) + 8), mbt_ffi_load32((iter_base) + 12))

            let result1 = mbt_ffi_ptr2str(mbt_ffi_load32((iter_base) + 16), mbt_ffi_load32((iter_base) + 20))

            let array : Array[String] = [];
            for index = 0; index < (mbt_ffi_load32((iter_base) + 28)); index = index + 1 {
                  let iter_base = (mbt_ffi_load32((iter_base) + 24)) + (index * 8)

                  let result2 = mbt_ffi_ptr2str(mbt_ffi_load32((iter_base) + 0), mbt_ffi_load32((iter_base) + 4))

                  array.push(result2)
            }
            mbt_ffi_free(mbt_ffi_load32((iter_base) + 24))

            let result3 = mbt_ffi_ptr2str(mbt_ffi_load32((iter_base) + 32), mbt_ffi_load32((iter_base) + 36))

            array4.push(@types.CommandMeta::{name : result, summary : result0, usage : result1, aliases : array, version : result3, hidden : (mbt_ffi_load8_u((iter_base) + 40) != 0)})
      }
      mbt_ffi_free(mbt_ffi_load32((return_area) + 0))
      mbt_ffi_free(return_area)
      return array4

}
///|
pub fn run(name : String, argv : Array[String]) -> Result[UInt, @types.CommandError] {

      let cleanup_list : Array[Int] = []

      let ptr = mbt_ffi_str2ptr(name)

      let address = mbt_ffi_malloc((argv).length() * 8);
      for index = 0; index < (argv).length(); index = index + 1 {
            let iter_elem : String = (argv)[(index)]
            let iter_base = address + (index * 8);

            let ptr0 = mbt_ffi_str2ptr(iter_elem)
            mbt_ffi_store32((iter_base) + 4, iter_elem.length())
            mbt_ffi_store32((iter_base) + 0, ptr0)
            mbt_ffi_free(ptr0)

      }
      let return_area = mbt_ffi_malloc(16)
      wasmImportRun(ptr, name.length(), address, (argv).length(), return_area);

      let lifted3 = match (mbt_ffi_load8_u((return_area) + 0)) {
            0 => {

                  Result::Ok((mbt_ffi_load32((return_area) + 4)).reinterpret_as_uint())
            }
            1 => {

                  let lifted = match (mbt_ffi_load8_u((return_area) + 4)) {
                        0 => {

                              let result = mbt_ffi_ptr2str(mbt_ffi_load32((return_area) + 8), mbt_ffi_load32((return_area) + 12))

                              @types.CommandError::UnknownCommand(result)
                        }
                        1 => {

                              let result1 = mbt_ffi_ptr2str(mbt_ffi_load32((return_area) + 8), mbt_ffi_load32((return_area) + 12))

                              @types.CommandError::InvalidArgs(result1)
                        }
                        2 => {

                              let result2 = mbt_ffi_ptr2str(mbt_ffi_load32((return_area) + 8), mbt_ffi_load32((return_area) + 12))

                              @types.CommandError::Failed(result2)
                        }
                        _ => panic()
                  }

                  Result::Err(lifted)
            }
            _ => panic()
      }
      mbt_ffi_free(ptr)
      mbt_ffi_free(address)
      mbt_ffi_free(return_area)

      cleanup_list.each(mbt_ffi_free)
      return lifted3

}

